# Ïƒâ‚‚: System Patterns

_v1.1 | Created: 2024-12-28 | Updated: 2024-12-28_
_Î : ğŸ—ï¸DEVELOPMENT | Î©: ğŸ”RESEARCH_

## ğŸ›ï¸ Architecture Overview

OntaPay é‡‡ç”¨ç°ä»£åŒ–çš„å‰ç«¯æ¶æ„æ¨¡å¼ï¼ŒåŸºäºç»„ä»¶åŒ–è®¾è®¡å’Œæ¨¡å—åŒ–å¼€å‘ç†å¿µã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Presentation Layer                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React Components + TailwindCSS + DaisyUI              â”‚
â”‚  â”œâ”€â”€ routes/          (é¡µé¢è·¯ç”±ç»„ä»¶)                    â”‚
â”‚  â”œâ”€â”€ components/      (å¯å¤ç”¨UIç»„ä»¶)                    â”‚
â”‚  â””â”€â”€ wallets/         (é’±åŒ…ç›¸å…³ç»„ä»¶: OKX, Phantom, Trust) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Business Logic Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Hooks + Utils + API                                   â”‚
â”‚  â”œâ”€â”€ hooks/           (è‡ªå®šä¹‰React Hooks)              â”‚
â”‚  â”œâ”€â”€ utils/           (å·¥å…·å‡½æ•°)                        â”‚
â”‚  â”œâ”€â”€ api/             (APIè°ƒç”¨é€»è¾‘)                     â”‚
â”‚  â””â”€â”€ types/           (TypeScriptç±»å‹å®šä¹‰)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Integration Layer                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Wallet Adapters + Blockchain SDKs                     â”‚
â”‚  â”œâ”€â”€ @okxconnect/solana-provider                       â”‚
â”‚  â”œâ”€â”€ @solana/web3.js                                   â”‚
â”‚  â”œâ”€â”€ @solana/spl-token                                 â”‚
â”‚  â”œâ”€â”€ Trust Wallet SDK (è®¡åˆ’é›†æˆ)                       â”‚
â”‚  â””â”€â”€ viem (ä»¥å¤ªåŠå…¼å®¹)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ Core Design Patterns

### 1. ğŸ¯ Provider Pattern

- **WalletProvider**: ç»Ÿä¸€é’±åŒ…çŠ¶æ€ç®¡ç†
- **Context API**: å…¨å±€çŠ¶æ€å…±äº«
- **é€‚é…å™¨æ¨¡å¼**: ä¸åŒé’±åŒ…çš„ç»Ÿä¸€æ¥å£

### 2. ğŸ§© Component Composition

- **é€šç”¨ç»„ä»¶**: ç»Ÿä¸€çš„é’±åŒ…äº¤äº’ç•Œé¢è®¾è®¡
- **åŸå­åŒ–ç»„ä»¶**: åŸºäº Radix UI çš„å¯å¤ç”¨ç»„ä»¶
- **å¤åˆç»„ä»¶**: ä¸šåŠ¡é€»è¾‘å°è£…ï¼Œå…¼å®¹å¤šé’±åŒ…
- **HOCæ¨¡å¼**: é’±åŒ…è¿æ¥çŠ¶æ€å¢å¼º

### 3. ğŸ”„ State Management

- **React Hooks**: æœ¬åœ°çŠ¶æ€ç®¡ç†
- **Context + Reducer**: å¤æ‚çŠ¶æ€é€»è¾‘
- **Custom Hooks**: ä¸šåŠ¡é€»è¾‘æŠ½è±¡

### 4. ğŸ›£ï¸ Routing Architecture

- **æ–‡ä»¶ç³»ç»Ÿè·¯ç”±**: TanStack Router è‡ªåŠ¨ç”Ÿæˆ
- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶è·¯ç”±éªŒè¯
- **åµŒå¥—è·¯ç”±**: æ”¯æŒå¤æ‚é¡µé¢ç»“æ„

## ğŸ” Security Patterns

- **é’±åŒ…ç­¾åéªŒè¯**: äº¤æ˜“å‰å¼ºåˆ¶ç”¨æˆ·ç¡®è®¤
- **è¾“å…¥éªŒè¯**: æ‰€æœ‰ç”¨æˆ·è¾“å…¥çš„ä¸¥æ ¼æ ¡éªŒ
- **é”™è¯¯è¾¹ç•Œ**: ç»„ä»¶çº§é”™è¯¯å¤„ç†
- **CSPç­–ç•¥**: å†…å®¹å®‰å…¨ç­–ç•¥é…ç½®

## ğŸ“± Mobile-First Design Patterns

- **ç§»åŠ¨ç«¯ä¸“ç”¨**: ä¸“æ³¨æ‰‹æœºç½‘é¡µä½“éªŒè®¾è®¡
- **è§¦æ‘¸ä¼˜åŒ–**: ç§»åŠ¨ç«¯äº¤äº’å’Œæ‰‹åŠ¿æ”¯æŒ
- **é’±åŒ…åº”ç”¨äº¤äº’**: Deep Link ä¸ç§»åŠ¨é’±åŒ… App é›†æˆ
- **PWAå°±ç»ª**: æ¸è¿›å¼Webåº”ç”¨æ”¯æŒ

## ğŸ”„ Data Flow Patterns

```
User Action â†’ Component â†’ Hook â†’ API/Wallet â†’ Blockchain
     â†“           â†“        â†“       â†“           â†“
   Event    State Update  Logic  Network    Transaction
     â†“           â†“        â†“       â†“           â†“
  UI Update â† Component â† Hook â† Response â† Confirmation
```

## ğŸ§ª Testing Patterns

- **ç»„ä»¶æµ‹è¯•**: React Testing Library
- **é›†æˆæµ‹è¯•**: ç«¯åˆ°ç«¯ç”¨æˆ·æµç¨‹
- **é’±åŒ…æ¨¡æ‹Ÿ**: æµ‹è¯•ç¯å¢ƒé’±åŒ…é€‚é…å™¨
- **ç±»å‹æ£€æŸ¥**: TypeScript ç¼–è¯‘æ—¶éªŒè¯
